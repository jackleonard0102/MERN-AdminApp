"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[394],{8394:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var o=t(5043),a=t(9800),l=t(1645),i=t(2492),r=t(2019),n=t(9748),c=t(3395),d=t(914),p=t(9029),u=t(5444),m=t(7021),h=t(2645),g=t(9456),f=t(3418),x=t(8402),y=t(6024),A=t(579);const{Title:j,Text:w}=i.A,v=e=>{const s="image/jpeg"===e.type||"image/png"===e.type||"image/webp"===e.type;s||r.Ay.error("You can only upload JPG/PNG/WEBP file!");const t=e.size/1024/1024<2;return t||r.Ay.error("Image must be smaller than 2MB!"),s&&t};const S=function(){const[e]=n.A.useForm(),s=(0,g.d4)((e=>e.auth.loader)),t=(0,g.d4)((e=>e.auth.user)),[a,l]=((0,g.d4)((e=>e.auth.errors)),(0,o.useState)(0)),i=(0,g.wA)(),[S,C]=(0,o.useState)(!1),[N,T]=(0,o.useState)(t.logo),[U,b]=(0,o.useState)(null);return(0,o.useEffect)((()=>{}),[i]),(0,A.jsxs)(c.A,{className:"max-w-xl w-full shadow-lg",children:[(0,A.jsxs)("div",{className:"my-4",children:[(0,A.jsx)(j,{level:3,children:"Welcome Page Information"}),(0,A.jsx)(w,{type:"secondary",children:"Update your welcome page's logo, site code, and app version."})]}),(0,A.jsxs)(n.A,{name:"settings",form:e,initialValues:{siteCode:t.siteCode||"",appVersion:t.appVersion||""},className:"form",scrollToFirstError:!0,onFinish:e=>{console.log("Received values of form: ",e),(async e=>{try{const s=await fetch("".concat(f.A.HOST_URL,"settings/update"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:(0,x.c7)("token")},body:JSON.stringify({siteCode:e.siteCode,appVersion:e.appVersion})});(await s.json()).success?r.Ay.success("Settings updated successfully"):r.Ay.error("Failed to update settings")}catch(s){r.Ay.error("Error updating settings"),console.error(s)}})(e)},children:[(0,A.jsx)(n.A.Item,{name:"logo",children:(0,A.jsx)(h.A,{rotationSlider:!0,children:(0,A.jsx)(d.A,{name:"file",listType:"picture-card",className:"logo-uploader",multiple:!1,showUploadList:!1,action:"".concat(f.A.HOST_URL,"settings/upload-logo"),accept:"image/*",headers:{Authorization:(0,x.c7)("token")},data:{oldFile:N},beforeUpload:v,onChange:e=>{if(console.log("Upload Status:",e.file.status),console.log("Response:",e.file.response),"uploading"!==e.file.status)if("done"===e.file.status){var s;const t="".concat(f.A.SOCKET_URL).concat(null===(s=e.file.response)||void 0===s?void 0:s.path);console.log("New Image URL:",t),T(t),b(t),C(!1),i((0,y.wz)()),l((e=>e+1))}else"error"===e.file.status&&(r.Ay.error("Upload failed."),C(!1));else C(!0)},children:S?(0,A.jsx)(p.A,{}):(0,A.jsxs)("div",{className:"relative",children:[(0,A.jsx)("img",{src:U||N?"".concat(U||N,"?t=").concat((new Date).getTime()):"/imgs/logo.jpg",alt:"logo",className:"w-full"}),(0,A.jsx)("div",{className:"absolute top-0 left-0 w-full h-full hover:bg-[#000a] opacity-0 hover:opacity-100 flex items-center justify-center text-white",children:"Change"})]})})})}),(0,A.jsx)(n.A.Item,{name:"siteCode",rules:[{required:!0,message:"Please input the Site Code!"}],children:(0,A.jsx)(u.A,{size:"large",placeholder:"Site Code"})}),(0,A.jsx)(n.A.Item,{name:"appVersion",rules:[{required:!0,message:"Please input the App Version!"}],children:(0,A.jsx)(u.A,{size:"large",placeholder:"App Version"})}),(0,A.jsx)(n.A.Item,{children:(0,A.jsx)(m.Ay,{loading:s,type:"primary",htmlType:"submit",className:"mt-2",size:"large",children:"Save"})})]})]})};const C=function(){return(0,A.jsx)("div",{className:"container mx-auto my-4 px-4",children:(0,A.jsx)(a.A,{gutter:[16,16],children:(0,A.jsx)(l.A,{span:24,className:"flex justify-center",children:(0,A.jsx)(S,{})})})})}}}]);
//# sourceMappingURL=394.092eced9.chunk.js.map